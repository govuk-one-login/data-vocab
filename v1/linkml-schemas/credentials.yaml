id: https://vocab.account.gov.uk/linkml/credentials-schema
name: credentials
description: >-
  
prefixes:
  linkml: https://w3id.org/linkml/
  schema: https://schema.org/
  vc: https://www.w3.org/2018/credentials/v1/
  di_vocab: https://vocab.account.gov.uk/v1/
imports:
  - linkml:types
  - ./person
  - ./evidence
  - ./vectorsOfTrust
  - ./verifiableIdentityCredential
  - ./identityCheckCredential
default_curi_maps:
  - semweb_context  
default_prefix: di_vocab
default_range: string

classes:
  JWTClass:
    slots:
      - iss
      - sub
      - nbf
      - exp
      - aud
      - iat
  AuthorizationRequestClass:
    is_a: JWTClass
    slots:
      - response_type
      - scope
      - client_id
      - state
      - redirect_uri
      - nonce
      - prompt
      - vtr
      - claims
  
  CoreIdentityJWTClass:
    is_a: JWTClass
    slots:
      - vc
      - vot
      - vtm
    slot_usage:
      vc:
        range: VerifiableIdentityCredentialClass
        required: true

  IdentityCheckCredentialJWTClass:
    is_a: JWTClass
    slots:
      - vc
    slot_usage:
      vc:
        range: IdentityCheckCredentialClass
        required: true

  VerifiableCredentialClass:
    class_uri: vc:VerifiableCredentialClass
    slots:
      - credentialSubject
      - "@context"

slots:
  credentialJWT:
    range: JWS
    multivalued: true
    inlined_as_list: true
  coreIdentity:
    range: PersonWithOnlyCoreAttributesClass
  iss:
    range: uri
  sub:
    range: uri
  nbf:
    range: integer
  exp:
    range: integer
  iat:
    range: integer
  aud:
    range: uri
  vc:
    range: VerifiableCredentialClass
  credentialSubject:
    range: PersonClass
  claims:
    range: PersonClass
    description: The claims.  This value will detail what additional claims, if any, are required from the /userinfo endpoint after a successful authentication request.
  response_type:
    range: string
    required: true
    description: The response type.  This value currently needs to be set to the value `code`.
  redirect_uri:
    range: uri
    required: true
    description: The redirect uri.  This value must exactly match one of the redirect uris registered by the Relying Party service and must be URL-encoded.
  state:
    range: string
    required: true
    description: The state.  This value is used to validate the response sent to the redirect URI.  This value will be returned to the client in the authentication response.
  client_id:
    range: StringOrURI
    required: true
    description: The client id.  This value is the client id the Relying Party service was provided with for identification upon registration.
  scope:
    range: string
    required: true
    description: The scope.  A space-separated list of scopes which must include the `openid` value. Other options are `email`, `phone` and `offline_access` (returns a refresh token).
  nonce:
    range: string
    required: true
    description: The nonce.  A random value provided from the ID token to verify the integrity of the ID token.
  vtr:
    range: string
    description: The Vector of Trust request. If not specified the default value `Cl.Cm` is used. Further information can be found in [Vectors of Trust RFC](https://datatracker.ietf.org/doc/rfc8485/)
  prompt:
    range: string
    description: Use the value `login` to force a user to authenticate again even if they have an existing session.  If this is not set a user will authenticate silently if they have an existing session.

# there must be a better way
enums:
  IdentityCheckCredentialType:
    permissible_values:
      IdentityCheckCredential:
      VerifiableCredential:
  VerifiableIdentityCredentialType:
    permissible_values:
      VerifiableIdentityCredential:
      VerifiableCredential: